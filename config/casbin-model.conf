# Casbin 授权模型配置
# Casbin Authorization Model Configuration
#
# 模型类型：RBAC with Domains（支持多租户）
# Model Type: RBAC with Domains (Multi-tenancy Support)
#
# 本模型定义了基于角色的访问控制（RBAC）并支持多租户隔离。
# This model defines Role-Based Access Control (RBAC) with multi-tenancy isolation.
#
# 策略格式 | Policy Format:
# - 角色分配 | Role Assignment: g, user:{userId}, role:{roleId}, tenant:{tenantId}
# - 权限分配 | Permission Assignment: p, role:{roleId}, tenant:{tenantId}, {resource}, {action}
#
# 示例 | Examples:
# g, user:1, role:2, tenant:1
# p, role:2, tenant:1, forms, view
#
# @see https://casbin.org/docs/rbac-with-domains
# @see https://github.com/php-casbin/php-casbin

[request_definition]
# 请求定义 | Request Definition
# sub: 主体（用户）| Subject (User)
# dom: 域（租户）| Domain (Tenant)
# obj: 对象（资源）| Object (Resource)
# act: 操作（动作）| Action
r = sub, dom, obj, act

[policy_definition]
# 策略定义 | Policy Definition
# sub: 主体（角色）| Subject (Role)
# dom: 域（租户）| Domain (Tenant)
# obj: 对象（资源）| Object (Resource)
# act: 操作（动作）| Action
p = sub, dom, obj, act

[role_definition]
# 角色定义 | Role Definition
# 定义角色继承关系，支持多租户
# Define role inheritance with multi-tenancy support
# 格式 | Format: g, user:{userId}, role:{roleId}, tenant:{tenantId}
g = _, _, _

[policy_effect]
# 策略效果 | Policy Effect
# 只要有一个策略允许，则允许访问
# Allow access if at least one policy allows
e = some(where (p.eft == allow))

[matchers]
# 匹配器 | Matchers
# 匹配规则：
# 1. 用户在指定租户中拥有指定角色
# 2. 租户匹配
# 3. 资源匹配
# 4. 操作匹配
#
# Matching rules:
# 1. User has the specified role in the specified tenant
# 2. Tenant matches
# 3. Resource matches
# 4. Action matches
m = g(r.sub, p.sub, r.dom) && r.dom == p.dom && r.obj == p.obj && r.act == p.act

