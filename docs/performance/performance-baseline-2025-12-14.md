# 性能基线报告 | Performance Baseline Report

> **创建日期**: 2025-12-14  
> **版本**: Phase 1 Baseline  
> **环境**: Docker 开发环境 (PHP 8.2.29, MySQL 8.0)

---

## 一、概述

本文档记录 AlkaidSYS 项目 Phase 1 阶段的性能基线指标，作为后续优化的对比基准。

---

## 二、测试环境

| 项目 | 值 |
|------|-----|
| PHP 版本 | 8.2.29 |
| MySQL 版本 | 8.0 |
| Redis 版本 | 7.x |
| 运行环境 | Docker (alkaid-backend) |
| 测试框架 | PHPUnit 11.5.44 |

---

## 三、关键路径性能指标

### 3.1 认证相关 API

| API | 方法 | 预期响应时间 | 备注 |
|-----|------|-------------|------|
| `/v1/auth/login` | POST | < 200ms | 包含密码验证和 JWT 生成 |
| `/v1/auth/me` | GET | < 50ms | 需要 JWT 验证 |
| `/v1/auth/refresh` | POST | < 100ms | Token 刷新 |
| `/v1/auth/logout` | POST | < 50ms | Token 黑名单 |

### 3.2 低代码集合 API

| API | 方法 | 预期响应时间 | 备注 |
|-----|------|-------------|------|
| `GET /v1/lowcode/collections` | GET | < 100ms | 列表查询（分页） |
| `GET /v1/lowcode/collections/:name` | GET | < 50ms | 单个集合详情 |
| `POST /v1/lowcode/collections` | POST | < 500ms | 创建集合（含 DDL） |
| `DELETE /v1/lowcode/collections/:name` | DELETE | < 500ms | 删除集合（含 DDL） |

### 3.3 表单 API

| API | 方法 | 预期响应时间 | 备注 |
|-----|------|-------------|------|
| `GET /v1/lowcode/forms` | GET | < 100ms | 列表查询 |
| `GET /v1/lowcode/forms/:name` | GET | < 50ms | 表单详情 |
| `POST /v1/lowcode/forms` | POST | < 200ms | 创建表单 |

---

## 四、数据库查询指标

### 4.1 SQL 查询次数基线

| 操作 | 预期 SQL 次数 | 备注 |
|------|--------------|------|
| 获取单个集合 | ≤ 3 | 集合 + 字段 + 关系 |
| 列出集合（分页） | ≤ 2 | COUNT + SELECT |
| 创建集合 | ≤ 5 | DDL + 元数据插入 |

### 4.2 缓存命中率目标

| 缓存类型 | 目标命中率 | 备注 |
|----------|-----------|------|
| 集合元数据缓存 | > 80% | 热点数据 |
| 权限缓存 | > 90% | 用户权限 |
| 配置缓存 | > 95% | 系统配置 |

---

## 五、多租户隔离性能

### 5.1 E2E 测试结果

| 测试用例 | 状态 | 执行时间 |
|----------|------|----------|
| 跨租户访问拒绝 | ✅ PASS | < 100ms |
| 租户隔离集合 | ✅ PASS | < 200ms |
| 租户切换隔离 | ✅ PASS | < 200ms |

### 5.2 租户隔离查询开销

- 所有业务查询自动添加 `tenant_id` 过滤
- 索引覆盖：`tenant_id` 字段已建立索引
- 预期额外开销：< 5%

---

## 六、测试覆盖

| 测试套件 | 测试数 | 状态 |
|----------|--------|------|
| Unit | 191 | ✅ PASS |
| Feature | 10+ | ✅ PASS |
| Integration | 21 | ✅ PASS |
| E2E | 3 | ✅ PASS |

---

## 七、后续优化建议

1. **数据库索引优化**：
   - 分析慢查询日志
   - 添加复合索引

2. **缓存策略优化**：
   - 实现缓存预热
   - 优化缓存失效策略

3. **API 响应优化**：
   - 实现响应压缩
   - 优化 JSON 序列化

4. **负载测试**：
   - 使用 k6 或 JMeter 进行压力测试
   - 建立并发用户基线

---

## 八、变更历史

| 日期 | 版本 | 变更内容 |
|------|------|----------|
| 2025-12-14 | 1.0 | 初始基线建立 |

