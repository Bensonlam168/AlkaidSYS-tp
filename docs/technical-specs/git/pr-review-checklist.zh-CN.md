# PR Review Checklist（PR 评审检查清单）

> 本清单用于指导评审者在对 PR 进行审核时，系统性地对照各类技术规范。

## 1. 通用

- [ ] PR 标题与描述清晰说明意图与主要变更内容；
- [ ] 关联的 Backlog 条目 / Issue 已在描述中链接；
- [ ] 变更范围适中，未引入明显“顺手改一大片”的范围膨胀。
- [ ] 在执行 Git 操作前已检查远程配置（详见“远程仓库安全检查”相关规范）。

## 2. API 设计规范

- [ ] 新增 / 变更的接口符合 API 设计规范（`api-specification*.md`）；
- [ ] HTTP 方法、路径、状态码与响应格式与规范保持一致；
- [ ] 错误响应使用统一的错误格式与错误码；
- [ ] 分页 / 过滤 / 排序等语义遵守项目约定。

## 3. 安全规范

- [ ] 认证 / 授权 / Casbin 相关变更遵守安全设计规范；
- [ ] 权限使用 `resource:action` 字符串权限码，并与 `permissions.slug=resource.action` 映射一致；
- [ ] 限流行为（Phase 1 / Phase 2）在适用场景下得到正确处理；
- [ ] 未在日志或其他输出中泄露敏感信息，重要数据有适当保护措施。

## 4. 数据库规范

- [ ] schema 与迁移遵守命名、多租户键（`tenant_id` / `site_id`）等规则；
- [ ] 关键索引包含多租户键，避免全表扫描或跨租户扫描；
- [ ] 无明显 N+1 查询，查询模式合理（预加载 / Join 等）；
- [ ] 对长耗时或复杂查询有合理说明与必要的监控/优化计划。

## 5. 测试规范

- [ ] 新增 / 变更的行为已有单测 / 集成 / 特性测试覆盖；
- [ ] 行为发生变化时，已有测试已同步更新；
- [ ] 本地或 CI 上的测试全部通过（后端 / 前端视情况而定）。

## 6. 性能与扩展性

- [ ] 对关键路径进行了性能影响评估，无明显退化；
- [ ] 数据库查询遵守性能规范并使用合适索引；
- [ ] 缓存与失效策略合理，避免“缓存雪崩 / 脑裂”等风险；
- [ ] 限流与背压策略在高并发场景下有清晰考虑。

## 7. 低代码规范

- [ ] 低代码引擎相关变更遵守 `lowcode-guidelines*.md`；
- [ ] Domain/Lowcode 仍然是唯一事实来源，未引入绕过路径；
- [ ] 未在新功能中增加对 Legacy 低代码模块的硬依赖。

## 8. 部署与运维

- [ ] 新增环境变量 / 配置项已在文档中说明，并提供安全默认值；
- [ ] 日志 / 指标 / Trace ID 在必要处已补充或更新；
- [ ] 如涉及部署顺序 / 迁移步骤，已在文档中清晰描述。

## 9. Git 工作流与提交规范

- [ ] 分支命名符合 Git 工作流规范（`feature|fix|hotfix|release` 等）；
- [ ] Commit 消息符合 Conventional Commits 与项目级规则（type / scope / subject 等）；
- [ ] 对于体量较大的改动，是否已拆分为相对独立、可评审的多个提交。

