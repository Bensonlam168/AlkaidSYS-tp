# Environment Variables Reference | 环境变量参考

> Generated by `php think env:check --generate`  
> Last updated: 2025-12-14

本文档列出了 AlkaidSYS 后端所有支持的环境变量，按功能分类说明其用途、类型和默认值。

## 快速开始

1. 复制 `.env.example` 为 `.env`
2. 根据环境调整配置
3. 运行 `php think env:check` 验证配置完整性

---

## Application | 应用配置

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `APP_ENV` | ✅ | `local` | 应用环境：`local`, `dev`, `testing`, `staging`, `production` |
| `APP_DEBUG` | ✅ | `true` | 调试模式：生产环境必须为 `false` |
| `DEFAULT_LANG` | | `zh-cn` | 默认语言：`zh-cn`, `en-us` |

---

## Database | 数据库配置

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `DB_TYPE` | | `mysql` | 数据库类型 |
| `DB_DRIVER` | | `mysql` | 数据库驱动 |
| `DB_HOST` | ✅ | `mysql` | 数据库主机 |
| `DB_PORT` | | `3306` | 数据库端口 |
| `DB_NAME` | ✅ | | 数据库名称 |
| `DB_USER` | ✅ | `root` | 数据库用户名 |
| `DB_PASS` | ✅ | | 数据库密码（生产环境必填） |
| `DB_CHARSET` | | `utf8mb4` | 数据库字符集 |
| `DB_PREFIX` | | | 表前缀 |

---

## Security | 安全配置

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `JWT_SECRET` | ✅ | `CHANGE_THIS_IN_PRODUCTION` | JWT 签名密钥（生产环境必须修改） |
| `JWT_ISSUER` | ✅ | `https://api.alkaidsys.local` | JWT 签发者 (iss) |
| `CORS_ALLOWED_ORIGINS` | | | CORS 允许的源（逗号分隔） |

---

## Redis/Cache | 缓存配置

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `REDIS_HOST` | ✅ | `redis` | Redis 主机 |
| `REDIS_PORT` | | `6379` | Redis 端口 |
| `REDIS_PASSWORD` | | | Redis 密码 |
| `REDIS_DB` | | `0` | Redis 数据库索引 |
| `CACHE_DRIVER` | | `file` | 缓存驱动：`file`, `redis`（生产环境强制 `redis`） |

---

## Authorization | 授权配置

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `CASBIN_ENABLED` | | `false` | 是否启用 Casbin 授权引擎 |
| `CASBIN_MODE` | | `DB_ONLY` | 运行模式：`DB_ONLY`, `CASBIN_ONLY`, `DUAL_MODE` |
| `CASBIN_LOG_ENABLED` | | `false` | 是否启用 Casbin 日志 |
| `CASBIN_CACHE_ENABLED` | | `true` | 是否启用 Casbin 缓存 |
| `CASBIN_CACHE_TTL` | | `3600` | 缓存过期时间（秒） |
| `CASBIN_RELOAD_TTL` | | `300` | 策略刷新间隔（秒） |

---

## Rate Limiting | 限流配置

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `RATELIMIT_ENABLED` | | `false` | 是否启用限流 |
| `RATELIMIT_STORE` | | `redis` | 限流存储驱动 |
| `RATELIMIT_DEFAULT_LIMIT` | | `60` | 默认限流阈值（次/周期） |
| `RATELIMIT_DEFAULT_PERIOD` | | `60` | 默认限流周期（秒） |

---

## DDL Guard | DDL 保护

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `SCHEMA_RUNTIME_DDL_ALLOWED_ENVS` | | `dev,local,testing` | 允许运行时 DDL 的环境 |
| `ALLOW_RUNTIME_DDL` | | `false` | 是否允许运行时 DDL |

---

## 验证命令

```bash
# 检查环境变量完整性
docker exec alkaid-backend php think env:check

# 严格模式（警告也视为失败）
docker exec alkaid-backend php think env:check --strict

# 生成文档模板
docker exec alkaid-backend php think env:check --generate
```

---

## 生产环境检查清单

在部署到生产环境之前，请确保：

- [ ] `APP_ENV=production` 或 `prod`
- [ ] `APP_DEBUG=false`
- [ ] `JWT_SECRET` 已修改为强随机密钥
- [ ] `DB_PASS` 已设置强密码
- [ ] `CORS_ALLOWED_ORIGINS` 已明确配置
- [ ] `CACHE_DRIVER=redis`

